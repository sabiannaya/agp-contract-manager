import{d as F,u as M,r as h,w as O,c as p,b as a,e as t,f as e,h as q,g as c,i as k,j as i,t as n,k as g,q as u}from"./app-D6ZExuG4.js";import{_ as A}from"./Heading.vue_vue_type_script_setup_true_lang-C_Qaqaft.js";import{_ as v}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BAMJN8k7.js";import{S as G,_ as H}from"./DataTable.vue_vue_type_script_setup_true_lang-LbyIga0L.js";import{_ as J,a as K,b as L,c as Q,d as R}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CgDzptfY.js";import{_ as W}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CmMndOaZ.js";import{v as y,_ as X,a as Y,b as Z,c as $,d as ee,u as te,y as se,j as ae,z as oe,A as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-DhQ7Babn.js";import{_ as ne}from"./Input.vue_vue_type_script_setup_true_lang-B9Upw0KD.js";import{E as ie,_ as re}from"./Pagination.vue_vue_type_script_setup_true_lang-DIGKOJqX.js";import{_ as ce}from"./StatusBadge.vue_vue_type_script_setup_true_lang-DTLVhpcY.js";import{u as ue}from"./useDateFormat-BThD_v7S.js";import{P as me}from"./plus-Ocys-J35.js";import{E as de}from"./eye-Cfy1nj4J.js";import{P as fe}from"./pencil-BG-Ex8ol.js";import{T as _e}from"./trash-2-DQ56K_0i.js";import{u as pe}from"./index-Dnaiof97.js";import"./createLucideIcon-BXqO2veZ.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Di4CQ4C5.js";import"./chevron-down-DKASTZ1i.js";import"./useForwardPropsEmits-BgLpAiDO.js";import"./VisuallyHidden-D-NgPM13.js";import"./useForwardExpose-6n7ayWvE.js";import"./index-BDqSilVs.js";const ke={class:"flex flex-col gap-6 p-6"},ve={class:"flex items-center justify-between"},be={class:"flex items-center gap-4"},he={class:"relative flex-1 max-w-sm"},ge={class:"overflow-auto"},ye={class:"sr-only"},$e={class:"shrink-0 border-t bg-background pt-4"},Ke=F({__name:"Index",props:{tickets:{},filters:{}},setup(m){const d=m,{t:s}=M(),{formatDateOnly:C}=ue(),{canCreate:S,canUpdate:w,canDelete:z}=te(),D=[{title:s("nav.tickets"),href:y().url}],b=h(d.filters.search??""),P=pe(o=>{u.get(y().url,{...d.filters,search:o||void 0,page:1},{preserveState:!0,preserveScroll:!0})},300);O(b,o=>P(o));function V(o,r){u.get(y().url,{...d.filters,sort:o,direction:r},{preserveState:!0,preserveScroll:!0})}function N(o){u.get(o,{},{preserveState:!0,preserveScroll:!0})}const E=[{key:"number",label:s("tickets.number"),sortable:!0},{key:"date",label:s("tickets.date"),sortable:!0},{key:"vendor.name",label:s("tickets.vendor")},{key:"contract.number",label:s("tickets.contract")},{key:"documents_count",label:s("tickets.documents")},{key:"status",label:s("common.status"),sortable:!0},{key:"actions",label:"",class:"w-[70px]"}],f=h(!1),_=h(null);function T(){u.get(se().url)}function I(o){u.get(ae(o.id).url)}function j(o){u.get(oe(o.id).url)}function B(o){_.value=o,f.value=!0}function U(){_.value&&u.delete(le(_.value.id).url,{onSuccess:()=>{f.value=!1,_.value=null}})}return(o,r)=>(k(),p(ee,{breadcrumbs:D},{default:a(()=>[t(e(q),{title:e(s)("nav.tickets")},null,8,["title"]),c("div",ke,[c("div",ve,[t(A,{title:e(s)("nav.tickets"),description:e(s)("tickets.description")},null,8,["title","description"]),e(S)("tickets")?(k(),p(e(v),{key:0,onClick:T},{default:a(()=>[t(e(me),{class:"mr-2 size-4"}),i(" "+n(e(s)("tickets.create")),1)]),_:1})):g("",!0)]),c("div",be,[c("div",he,[t(e(G),{class:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-muted-foreground"}),t(e(ne),{modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=l=>b.value=l),placeholder:e(s)("common.search"),class:"pl-9"},null,8,["modelValue","placeholder"])])]),c("div",ge,[t(e(H),{columns:E,data:m.tickets.data,"sort-field":typeof d.filters.sort=="string"?d.filters.sort:void 0,"sort-direction":d.filters.direction,"empty-text":e(s)("common.no_data"),hoverable:"",onSort:V},{"cell-documents_count":a(({row:l})=>[i(n(l.documents_count)+"/5 ",1)]),"cell-date":a(({value:l})=>[i(n(e(C)(l)),1)]),"cell-status":a(({value:l})=>[t(e(ce),{status:l},null,8,["status"])]),"cell-actions":a(({row:l})=>[t(e(X),null,{default:a(()=>[t(e(Y),{"as-child":""},{default:a(()=>[t(e(v),{variant:"ghost",size:"icon",class:"size-8"},{default:a(()=>[t(e(ie),{class:"size-4"}),c("span",ye,n(e(s)("common.actions")),1)]),_:1})]),_:1}),t(e(Z),{align:"end"},{default:a(()=>[t(e($),{onClick:x=>I(l)},{default:a(()=>[t(e(de),{class:"mr-2 size-4"}),i(" "+n(e(s)("common.view")),1)]),_:1},8,["onClick"]),e(w)("tickets")?(k(),p(e($),{key:0,onClick:x=>j(l)},{default:a(()=>[t(e(fe),{class:"mr-2 size-4"}),i(" "+n(e(s)("common.edit")),1)]),_:1},8,["onClick"])):g("",!0),e(z)("tickets")?(k(),p(e($),{key:1,class:"text-destructive focus:text-destructive",onClick:x=>B(l)},{default:a(()=>[t(e(_e),{class:"mr-2 size-4"}),i(" "+n(e(s)("common.delete")),1)]),_:1},8,["onClick"])):g("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","sort-field","sort-direction","empty-text"])]),c("div",$e,[t(e(re),{links:m.tickets.links,from:m.tickets.from,to:m.tickets.to,total:m.tickets.total,onNavigate:N},null,8,["links","from","to","total"])])]),t(e(J),{open:f.value,"onUpdate:open":r[2]||(r[2]=l=>f.value=l)},{default:a(()=>[t(e(K),{class:"sm:max-w-100"},{default:a(()=>[t(e(L),null,{default:a(()=>[t(e(Q),null,{default:a(()=>[i(n(e(s)("common.confirm_delete")),1)]),_:1}),t(e(R),null,{default:a(()=>[i(n(e(s)("tickets.delete_confirmation",{number:_.value?.number})),1)]),_:1})]),_:1}),t(e(W),null,{default:a(()=>[t(e(v),{variant:"outline",onClick:r[1]||(r[1]=l=>f.value=!1)},{default:a(()=>[i(n(e(s)("common.cancel")),1)]),_:1}),t(e(v),{variant:"destructive",onClick:U},{default:a(()=>[i(n(e(s)("common.delete")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Ke as default};
