import{d as j,u as A,a as E,w,c as P,b as r,e as s,f as t,h as q,g as i,l as L,j as d,t as a,i as u,m,k as p,s as b,q as x}from"./app-CuI7LdXL.js";import{_ as M}from"./Heading.vue_vue_type_script_setup_true_lang-BHjUqA3V.js";import{_ as R}from"./index-D_NX9Eof.js";import{_ as g}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BUBYiqAX.js";import{_ as h,a as D,b as F,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-BhpnJ5ya.js";import{_ as S}from"./CardDescription.vue_vue_type_script_setup_true_lang-D4LN3jrC.js";import{_ as G}from"./Checkbox.vue_vue_type_script_setup_true_lang-BHWKOiH2.js";import{_ as H}from"./CurrencyInput.vue_vue_type_script_setup_true_lang-BsyeBIW3.js";import{_ as J}from"./Input.vue_vue_type_script_setup_true_lang-DLaguvqt.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-BVYJy_EQ.js";import{_ as U}from"./Select.vue_vue_type_script_setup_true_lang-QPZrs6lE.js";import{_ as K}from"./Textarea.vue_vue_type_script_setup_true_lang-BYhBP41M.js";import{r as Q,F as W,d as X,t as V,v as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-CwkbJi7E.js";import{A as Z}from"./arrow-left-DWqgfXPD.js";import{D as tt}from"./dollar-sign-DkALKasg.js";import{P as et}from"./plus-gEXAE-os.js";import"./index-BRm__Hk1.js";import"./useForwardPropsEmits-CaKxx7wQ.js";import"./VisuallyHidden-DxCKGmrj.js";import"./useForwardExpose-D4WvoR71.js";import"./VisuallyHiddenInput-8nto7-pU.js";import"./check-CLJgvc3L.js";import"./createLucideIcon-CX-op3lg.js";import"./chevron-down-DGBHzGpy.js";import"./index-BDqSilVs.js";const st={class:"flex h-full flex-1 flex-col gap-6 p-6"},ot={class:"flex items-center gap-4"},at={class:"grid gap-4 sm:grid-cols-2"},it={class:"space-y-2"},rt={key:0,class:"text-sm text-destructive"},ct={class:"space-y-2"},nt={key:0,class:"text-sm text-destructive"},lt={class:"space-y-2"},dt={key:0,class:"text-sm text-destructive"},ut={class:"space-y-2 sm:col-span-2"},_t={key:0,class:"text-sm text-destructive"},mt={class:"flex items-center space-x-2"},pt={class:"grid gap-4 sm:grid-cols-2"},ft={class:"space-y-2"},vt={class:"text-xs text-muted-foreground"},bt={key:0,class:"text-sm text-destructive"},kt={key:0,class:"rounded-lg border bg-muted/30 p-4"},xt={class:"mb-3 text-sm font-medium"},gt={class:"grid gap-3 sm:grid-cols-3"},ht={class:"text-muted-foreground text-xs"},yt={class:"font-semibold"},Vt={class:"text-muted-foreground text-xs"},$t={class:"font-semibold text-green-600"},Ct={class:"text-muted-foreground text-xs"},wt={class:"font-semibold text-orange-600"},Dt={key:0,class:"mt-3"},Ft={class:"text-sm text-blue-800 dark:text-blue-200"},St={class:"flex items-center justify-end gap-4"},ee=j({__name:"Create",props:{vendors:{},contracts:{}},setup(z){const f=z,{t:o}=A(),$=Q(),B=b(()=>[{title:o("nav.tickets"),href:V().url},{title:o("tickets.create"),href:"#"}]),I=b(()=>e.vendor_id?f.contracts.filter(c=>c.vendor_id===e.vendor_id):f.contracts),N=b(()=>f.vendors.map(c=>({value:c.id,label:`${c.code} - ${c.name}`}))),T=b(()=>I.value.map(c=>({value:c.id,label:c.number}))),e=E({date:new Date().toISOString().split("T")[0],contract_id:null,vendor_id:null,amount:null,reference_no:"",replaces_ticket_id:null,notes:"",is_active:!0}),_=b(()=>e.contract_id?f.contracts.find(c=>c.id===e.contract_id)??null:null);function k(c){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(c)}w(()=>e.vendor_id,c=>{if(c&&e.contract_id){const n=f.contracts.find(l=>l.id===e.contract_id);n&&n.vendor_id!==c&&(e.contract_id=null)}}),w(()=>e.contract_id,c=>{if(c){const n=f.contracts.find(l=>l.id===c);n&&(e.vendor_id=n.vendor_id)}});function C(){x.get(V().url)}function O(){e.post(Y().url,{preserveScroll:!0,onSuccess:c=>{$.success(o("tickets.created_successfully"));const n=c.props?.ticket?.id;n?x.visit(`/tickets/${n}/edit`):x.visit(V().url)},onError:()=>{$.error(o("tickets.create_failed"))}})}return(c,n)=>(u(),P(X,{breadcrumbs:B.value},{default:r(()=>[s(t(q),{title:t(o)("tickets.create")},null,8,["title"]),i("div",st,[i("div",ot,[s(t(g),{variant:"outline",size:"icon",onClick:C},{default:r(()=>[s(t(Z),{class:"size-4"})]),_:1}),s(M,{title:t(o)("tickets.create"),description:t(o)("tickets.create_description")},null,8,["title","description"])]),i("form",{onSubmit:L(O,["prevent"]),class:"space-y-6"},[s(t(h),null,{default:r(()=>[s(t(D),null,{default:r(()=>[s(t(F),{class:"flex items-center gap-2"},{default:r(()=>[s(t(W),{class:"size-5"}),d(" "+a(t(o)("tickets.ticket_info")),1)]),_:1}),s(t(S),null,{default:r(()=>[d(a(t(o)("tickets.create_info_description")),1)]),_:1})]),_:1}),s(t(y),{class:"space-y-4"},{default:r(()=>[i("div",at,[i("div",it,[s(t(v),null,{default:r(()=>[d(a(t(o)("tickets.date")),1)]),_:1}),s(t(J),{modelValue:t(e).date,"onUpdate:modelValue":n[0]||(n[0]=l=>t(e).date=l),type:"date",disabled:t(e).processing},null,8,["modelValue","disabled"]),t(e).errors.date?(u(),m("p",rt,a(t(e).errors.date),1)):p("",!0)]),i("div",ct,[s(t(v),null,{default:r(()=>[d(a(t(o)("tickets.vendor")),1)]),_:1}),s(t(U),{modelValue:t(e).vendor_id,"onUpdate:modelValue":n[1]||(n[1]=l=>t(e).vendor_id=l),options:N.value,placeholder:t(o)("tickets.select_vendor"),disabled:t(e).processing,clearable:""},null,8,["modelValue","options","placeholder","disabled"]),t(e).errors.vendor_id?(u(),m("p",nt,a(t(e).errors.vendor_id),1)):p("",!0)]),i("div",lt,[s(t(v),null,{default:r(()=>[d(a(t(o)("tickets.contract")),1)]),_:1}),s(t(U),{modelValue:t(e).contract_id,"onUpdate:modelValue":n[2]||(n[2]=l=>t(e).contract_id=l),options:T.value,placeholder:t(o)("tickets.select_contract"),disabled:t(e).processing,clearable:""},null,8,["modelValue","options","placeholder","disabled"]),t(e).errors.contract_id?(u(),m("p",dt,a(t(e).errors.contract_id),1)):p("",!0)]),i("div",ut,[s(t(v),null,{default:r(()=>[d(a(t(o)("tickets.notes")),1)]),_:1}),s(t(K),{modelValue:t(e).notes,"onUpdate:modelValue":n[3]||(n[3]=l=>t(e).notes=l),placeholder:t(o)("tickets.notes_placeholder"),disabled:t(e).processing,rows:3},null,8,["modelValue","placeholder","disabled"]),t(e).errors.notes?(u(),m("p",_t,a(t(e).errors.notes),1)):p("",!0)]),i("div",mt,[s(t(G),{id:"is_active",checked:t(e).is_active,"onUpdate:checked":n[4]||(n[4]=l=>t(e).is_active=l),disabled:t(e).processing},null,8,["checked","disabled"]),s(t(v),{for:"is_active",class:"font-normal"},{default:r(()=>[d(a(t(o)("common.active")),1)]),_:1})])])]),_:1})]),_:1}),s(t(h),null,{default:r(()=>[s(t(D),null,{default:r(()=>[s(t(F),{class:"flex items-center gap-2"},{default:r(()=>[s(t(tt),{class:"size-5"}),d(" "+a(t(o)("tickets.payment_amount")),1)]),_:1}),s(t(S),null,{default:r(()=>[d(a(t(o)("tickets.payment_amount_description")),1)]),_:1})]),_:1}),s(t(y),{class:"space-y-4"},{default:r(()=>[i("div",pt,[i("div",ft,[s(t(v),null,{default:r(()=>[d(a(t(o)("payment_tracker.amount")),1)]),_:1}),s(t(H),{modelValue:t(e).amount,"onUpdate:modelValue":n[5]||(n[5]=l=>t(e).amount=l),min:0,disabled:t(e).processing},null,8,["modelValue","disabled"]),i("p",vt,a(t(o)("tickets.amount_hint")),1),t(e).errors.amount?(u(),m("p",bt,a(t(e).errors.amount),1)):p("",!0)])]),_.value?(u(),m("div",kt,[i("p",xt,a(t(o)("payment_tracker.contract_balance")),1),i("div",gt,[i("div",null,[i("p",ht,a(t(o)("contracts.amount")),1),i("p",yt,a(k(_.value.amount)),1)]),i("div",null,[i("p",Vt,a(t(o)("contracts.total_paid")),1),i("p",$t,a(k(_.value.payment_total_paid??0)),1)]),i("div",null,[i("p",Ct,a(t(o)("contracts.outstanding_balance")),1),i("p",wt,a(k(_.value.payment_balance??_.value.amount)),1)])]),t(e).amount&&t(e).amount>(_.value.payment_balance??_.value.amount)?(u(),m("div",Dt,[s(t(R),{variant:"destructive"},{default:r(()=>[d(a(t(o)("tickets.amount_exceeds_balance")),1)]),_:1})])):p("",!0)])):p("",!0)]),_:1})]),_:1}),s(t(h),{class:"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950"},{default:r(()=>[s(t(y),{class:"p-4"},{default:r(()=>[i("p",Ft,a(t(o)("tickets.create_document_info")),1)]),_:1})]),_:1}),i("div",St,[s(t(g),{type:"button",variant:"outline",onClick:C,disabled:t(e).processing},{default:r(()=>[d(a(t(o)("common.cancel")),1)]),_:1},8,["disabled"]),s(t(g),{type:"submit",disabled:t(e).processing},{default:r(()=>[s(t(et),{class:"mr-2 size-4"}),d(" "+a(t(e).processing?t(o)("common.creating"):t(o)("tickets.create")),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["breadcrumbs"]))}});export{ee as default};
