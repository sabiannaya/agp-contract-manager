import{d as q,u as A,q as y,w as F,c as _,b as i,e as s,f as e,h as M,g as r,k,j as f,t as c,m as b,s as l}from"./app-Az55F6M8.js";import{_ as O,u as G}from"./useActionConfirmation-BPstB5Uy.js";import{_ as H}from"./Heading.vue_vue_type_script_setup_true_lang-DzT-PsX3.js";import{_ as C}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CjG2TDFh.js";import{S as J,_ as K}from"./DataTable.vue_vue_type_script_setup_true_lang-KlVNUek7.js";import{w as h,c as L,d as Q,e as R,f as x,_ as W,g as X,z as Y,m as Z,A as ee,D as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-DyTogOSr.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-9NyD3cCB.js";import{E as oe,_ as ae}from"./Pagination.vue_vue_type_script_setup_true_lang-DOeNEDps.js";import{_ as ie}from"./StatusBadge.vue_vue_type_script_setup_true_lang-Ik7GkR5h.js";import{u as ne}from"./useDateFormat-BThD_v7S.js";import{P as re}from"./plus-Rxuc06gk.js";import{E as ce}from"./eye-CfgMQgEh.js";import{P as le}from"./pencil-B0Lx0GLH.js";import{T as me}from"./trash-2-1tc8fb7c.js";import{u as ue}from"./index-Dwg1ok0u.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D7dEZzdR.js";import"./useForwardPropsEmits-DcGYh6Gw.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-CpvOfIA5.js";import"./createLucideIcon-iLJQO7DH.js";import"./Spinner.vue_vue_type_script_setup_true_lang-MOyKrSw-.js";import"./chevron-down-DzsoBm0Z.js";import"./VisuallyHidden-C4XAoWlX.js";import"./useForwardExpose-Dz4tKeCh.js";import"./index-BDqSilVs.js";const de={class:"flex flex-col gap-6 p-6"},fe={class:"flex items-center justify-between"},pe={class:"flex items-center gap-4"},_e={class:"relative flex-1 max-w-sm"},ke={class:"overflow-auto"},ve={class:"sr-only"},be={class:"shrink-0 border-t bg-background pt-4"},Ge=q({__name:"Index",props:{tickets:{},filters:{}},setup(m){const u=m,{t}=A(),{formatDateOnly:$}=ne(),{canCreate:S,canUpdate:w,canDelete:z}=X(),n=G(),D=[{title:t("nav.tickets"),href:h().url}],v=y(u.filters.search??""),T=ue(o=>{l.get(h().url,{...u.filters,search:o||void 0,page:1},{preserveState:!0,preserveScroll:!0})},300);F(v,o=>T(o));function P(o,d){l.get(h().url,{...u.filters,sort:o,direction:d},{preserveState:!0,preserveScroll:!0})}function V(o){l.get(o,{},{preserveState:!0,preserveScroll:!0})}const N=[{key:"number",label:t("tickets.number"),sortable:!0},{key:"date",label:t("tickets.date"),sortable:!0},{key:"vendor.name",label:t("tickets.vendor")},{key:"contract.number",label:t("tickets.contract")},{key:"documents_count",label:t("tickets.documents")},{key:"status",label:t("common.status"),sortable:!0},{key:"actions",label:"",class:"w-[70px]"}],p=y(null);function E(){l.get(Y().url)}function I(o){l.get(Z(o.id).url)}function B(o){l.get(ee(o.id).url)}function U(o){p.value=o,n.requestConfirmation({title:t("common.confirm_delete"),description:t("tickets.delete_confirmation",{number:o.number}),confirmText:t("common.delete"),destructive:!0,details:[{label:t("tickets.number"),value:o.number}]},j)}function j(){p.value&&l.delete(te(p.value.id).url,{onSuccess:()=>{p.value=null}})}return(o,d)=>(k(),_(W,{breadcrumbs:D},{default:i(()=>[s(e(M),{title:e(t)("nav.tickets")},null,8,["title"]),r("div",de,[r("div",fe,[s(H,{title:e(t)("nav.tickets"),description:e(t)("tickets.description")},null,8,["title","description"]),e(S)("tickets")?(k(),_(e(C),{key:0,onClick:E},{default:i(()=>[s(e(re),{class:"mr-2 size-4"}),f(" "+c(e(t)("tickets.create")),1)]),_:1})):b("",!0)]),r("div",pe,[r("div",_e,[s(e(J),{class:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-muted-foreground"}),s(e(se),{modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=a=>v.value=a),placeholder:e(t)("common.search"),class:"pl-9"},null,8,["modelValue","placeholder"])])]),r("div",ke,[s(e(K),{columns:N,data:m.tickets.data,"sort-field":typeof u.filters.sort=="string"?u.filters.sort:void 0,"sort-direction":u.filters.direction,"empty-text":e(t)("common.no_data"),hoverable:"",onSort:P},{"cell-documents_count":i(({row:a})=>[f(c(a.documents_count)+"/5 ",1)]),"cell-date":i(({value:a})=>[f(c(e($)(a)),1)]),"cell-status":i(({value:a})=>[s(e(ie),{status:a},null,8,["status"])]),"cell-actions":i(({row:a})=>[s(e(L),null,{default:i(()=>[s(e(Q),{"as-child":""},{default:i(()=>[s(e(C),{variant:"ghost",size:"icon",class:"size-8"},{default:i(()=>[s(e(oe),{class:"size-4"}),r("span",ve,c(e(t)("common.actions")),1)]),_:1})]),_:1}),s(e(R),{align:"end"},{default:i(()=>[s(e(x),{onClick:g=>I(a)},{default:i(()=>[s(e(ce),{class:"mr-2 size-4"}),f(" "+c(e(t)("common.view")),1)]),_:1},8,["onClick"]),e(w)("tickets")?(k(),_(e(x),{key:0,onClick:g=>B(a)},{default:i(()=>[s(e(le),{class:"mr-2 size-4"}),f(" "+c(e(t)("common.edit")),1)]),_:1},8,["onClick"])):b("",!0),e(z)("tickets")?(k(),_(e(x),{key:1,class:"text-destructive focus:text-destructive",onClick:g=>U(a)},{default:i(()=>[s(e(me),{class:"mr-2 size-4"}),f(" "+c(e(t)("common.delete")),1)]),_:1},8,["onClick"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","sort-field","sort-direction","empty-text"])]),r("div",be,[s(e(ae),{links:m.tickets.links,from:m.tickets.from,to:m.tickets.to,total:m.tickets.total,onNavigate:V},null,8,["links","from","to","total"])])]),s(O,{open:e(n).open,"onUpdate:open":d[1]||(d[1]=a=>e(n).open=a),title:e(n).title,description:e(n).description,"confirm-text":e(n).confirmText,"cancel-text":e(n).cancelText,destructive:e(n).destructive,details:e(n).details,onConfirm:e(n).confirm,onCancel:e(n).cancel},null,8,["open","title","description","confirm-text","cancel-text","destructive","details","onConfirm","onCancel"])]),_:1}))}});export{Ge as default};
