import{d as z,u as E,a as L,c as D,b as r,e as t,f as e,h as M,g as l,y as C,i as R,j as m,t as a,k as u,l as v,m as b,F as G,r as H,p as J,s as K}from"./app-Az55F6M8.js";import{_ as O,u as Q}from"./useActionConfirmation-BPstB5Uy.js";import{_ as W}from"./Heading.vue_vue_type_script_setup_true_lang-DzT-PsX3.js";import{_ as y}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CjG2TDFh.js";import{_ as V,a as B,b as P,c as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-DL5VZqU4.js";import{_ as w}from"./CardDescription.vue_vue_type_script_setup_true_lang-xuWwyfVh.js";import{_ as x}from"./Checkbox.vue_vue_type_script_setup_true_lang-pmgtftpc.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-9NyD3cCB.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-BatJIAlb.js";import{_ as Y}from"./Textarea.vue_vue_type_script_setup_true_lang-DKZzY7Db.js";import{o as k,_ as Z,q as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DyTogOSr.js";import{A as se}from"./arrow-left-DLIy3lRN.js";import{S as te}from"./save-CpSwRFrC.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D7dEZzdR.js";import"./useForwardPropsEmits-DcGYh6Gw.js";import"./index-Dwg1ok0u.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-CpvOfIA5.js";import"./VisuallyHidden-C4XAoWlX.js";import"./VisuallyHiddenInput-dytHPRwB.js";import"./useForwardExpose-Dz4tKeCh.js";import"./check-CBSXup_1.js";import"./createLucideIcon-iLJQO7DH.js";import"./index-BDqSilVs.js";const ie={class:"p-6"},de={class:"flex gap-4 items-start"},oe={class:"grid gap-4 sm:grid-cols-2"},re={class:"space-y-2"},le={key:0,class:"text-sm text-destructive"},ae={key:1,class:"text-xs text-muted-foreground"},ne={class:"flex items-center space-x-2"},ce={class:"space-y-2"},me={key:0,class:"text-sm text-destructive"},fe={class:"space-y-4"},pe={class:"mb-3 flex items-center justify-between"},ue={class:"font-medium"},_e={class:"text-sm text-muted-foreground"},ve={class:"flex items-center gap-2"},xe={class:"text-xs text-muted-foreground"},he={class:"flex flex-wrap gap-4"},ge={class:"flex items-center space-x-2"},be={class:"flex items-center space-x-2"},ke={class:"flex items-center space-x-2"},ye={class:"flex items-center space-x-2"},$e={key:0,class:"mt-2 text-sm text-destructive"},Ue={class:"flex items-center justify-end gap-4"},Oe=z({__name:"Edit",props:{role:{},pages:{},privilegesByPage:{}},setup($){const f=$,{t:d}=E(),p=Q(),F=J(()=>[{title:d("nav.roles"),href:k().url},{title:f.role.name,href:"#"}]),A=f.pages.map(n=>({page_id:n.id,create:f.privilegesByPage[n.id]?.create||!1,read:f.privilegesByPage[n.id]?.read||!1,update:f.privilegesByPage[n.id]?.update||!1,delete:f.privilegesByPage[n.id]?.delete||!1})),i=L({name:f.role.name,description:f.role.description||"",is_active:f.role.is_active,privileges:A});function I(){i.put(ee(f.role.id).url,{preserveScroll:!0,onSuccess:()=>{K.visit(k().url)}})}function N(){p.requestConfirmation({title:d("common.update"),description:d("roles.edit_description"),confirmText:d("common.save"),details:[{label:d("roles.name"),value:i.name||"-"}]},I)}function T(n,o){const s=i.privileges.findIndex(c=>c.page_id===n);s!==-1&&(i.privileges[s].create=o,i.privileges[s].read=o,i.privileges[s].update=o,i.privileges[s].delete=o)}function h(n){return i.privileges.find(o=>o.page_id===n)}function g(n,o,s){const c=i.privileges.findIndex(q=>q.page_id===n);c!==-1&&(i.privileges[c][o]=s)}function j(n){const o=i.privileges.find(s=>s.page_id===n);return o?o.create&&o.read&&o.update&&o.delete:!1}function U(){return f.role?.is_system??!1}return(n,o)=>(u(),D(Z,{breadcrumbs:F.value},{default:r(()=>[t(e(M),{title:e(d)("roles.edit")},null,8,["title"]),l("div",ie,[l("div",de,[t(e(C),{href:e(k)().url},{default:r(()=>[t(e(y),{variant:"ghost",size:"icon"},{default:r(()=>[t(e(se),{class:"size-4"})]),_:1})]),_:1},8,["href"]),t(W,{title:e(d)("roles.edit"),description:e(d)("roles.edit_description")},null,8,["title","description"])]),l("form",{onSubmit:R(N,["prevent"]),class:"space-y-6"},[t(e(V),null,{default:r(()=>[t(e(B),null,{default:r(()=>[t(e(P),null,{default:r(()=>[m(a(e(d)("roles.basic_info")),1)]),_:1}),t(e(w),null,{default:r(()=>[m(a(e(d)("roles.basic_info_description")),1)]),_:1})]),_:1}),t(e(S),{class:"space-y-4"},{default:r(()=>[l("div",oe,[l("div",re,[t(e(_),{for:"name"},{default:r(()=>[m(a(e(d)("roles.name")),1)]),_:1}),t(e(X),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":o[0]||(o[0]=s=>e(i).name=s),disabled:e(i).processing||U(),required:""},null,8,["modelValue","disabled"]),e(i).errors.name?(u(),v("p",le,a(e(i).errors.name),1)):b("",!0),U()?(u(),v("p",ae,a(e(d)("roles.system_role_locked")),1)):b("",!0)]),l("div",ne,[t(e(x),{id:"is_active",checked:e(i).is_active,"onUpdate:checked":o[1]||(o[1]=s=>e(i).is_active=s),disabled:e(i).processing},null,8,["checked","disabled"]),t(e(_),{for:"is_active",class:"font-normal"},{default:r(()=>[m(a(e(d)("roles.is_active")),1)]),_:1})])]),l("div",ce,[t(e(_),{for:"description"},{default:r(()=>[m(a(e(d)("roles.description_field")),1)]),_:1}),t(e(Y),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":o[2]||(o[2]=s=>e(i).description=s),disabled:e(i).processing,rows:2},null,8,["modelValue","disabled"]),e(i).errors.description?(u(),v("p",me,a(e(i).errors.description),1)):b("",!0)])]),_:1})]),_:1}),t(e(V),null,{default:r(()=>[t(e(B),null,{default:r(()=>[t(e(P),null,{default:r(()=>[m(a(e(d)("roles.page_privileges")),1)]),_:1}),t(e(w),null,{default:r(()=>[m(a(e(d)("roles.page_privileges_description")),1)]),_:1})]),_:1}),t(e(S),null,{default:r(()=>[l("div",fe,[(u(!0),v(G,null,H($.pages,s=>(u(),v("div",{key:s.id,class:"rounded-lg border p-4"},[l("div",pe,[l("div",null,[l("h4",ue,a(s.name),1),l("p",_e,a(s.description),1)]),l("div",ve,[t(e(x),{checked:j(s.id),"onUpdate:checked":c=>T(s.id,c),disabled:e(i).processing},null,8,["checked","onUpdate:checked","disabled"]),l("span",xe,a(e(d)("common.select_all")),1)])]),l("div",he,[l("div",ge,[t(e(x),{id:`${s.id}-create`,checked:h(s.id)?.create??!1,"onUpdate:checked":c=>g(s.id,"create",c),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(_),{for:`${s.id}-create`,class:"font-normal text-sm"},{default:r(()=>[m(a(e(d)("common.create")),1)]),_:1},8,["for"])]),l("div",be,[t(e(x),{id:`${s.id}-read`,checked:h(s.id)?.read??!1,"onUpdate:checked":c=>g(s.id,"read",c),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(_),{for:`${s.id}-read`,class:"font-normal text-sm"},{default:r(()=>[m(a(e(d)("common.read")),1)]),_:1},8,["for"])]),l("div",ke,[t(e(x),{id:`${s.id}-update`,checked:h(s.id)?.update??!1,"onUpdate:checked":c=>g(s.id,"update",c),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(_),{for:`${s.id}-update`,class:"font-normal text-sm"},{default:r(()=>[m(a(e(d)("common.update")),1)]),_:1},8,["for"])]),l("div",ye,[t(e(x),{id:`${s.id}-delete`,checked:h(s.id)?.delete??!1,"onUpdate:checked":c=>g(s.id,"delete",c),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(_),{for:`${s.id}-delete`,class:"font-normal text-sm"},{default:r(()=>[m(a(e(d)("common.delete")),1)]),_:1},8,["for"])])])]))),128))]),e(i).errors.privileges?(u(),v("p",$e,a(e(i).errors.privileges),1)):b("",!0)]),_:1})]),_:1}),l("div",Ue,[t(e(C),{href:e(k)().url},{default:r(()=>[t(e(y),{type:"button",variant:"outline",disabled:e(i).processing},{default:r(()=>[m(a(e(d)("common.cancel")),1)]),_:1},8,["disabled"])]),_:1},8,["href"]),t(e(y),{type:"submit",disabled:e(i).processing},{default:r(()=>[t(e(te),{class:"mr-2 size-4"}),m(" "+a(e(i).processing?e(d)("common.saving"):e(d)("common.save")),1)]),_:1},8,["disabled"])])],32),t(O,{open:e(p).open,"onUpdate:open":o[3]||(o[3]=s=>e(p).open=s),title:e(p).title,description:e(p).description,"confirm-text":e(p).confirmText,"cancel-text":e(p).cancelText,destructive:e(p).destructive,details:e(p).details,onConfirm:e(p).confirm,onCancel:e(p).cancel},null,8,["open","title","description","confirm-text","cancel-text","destructive","details","onConfirm","onCancel"])])]),_:1},8,["breadcrumbs"]))}});export{Oe as default};
