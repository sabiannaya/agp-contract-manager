import{d as se,u as re,a as C,c as g,b as r,e as t,f as e,h as ne,g as s,j as c,t as a,i as d,k as p,m as u,F as oe,p as le,v as ce,n as ie,l as j,q as R,r as w}from"./app-CuI7LdXL.js";import{_ as de}from"./Heading.vue_vue_type_script_setup_true_lang-BHjUqA3V.js";import{_ as V}from"./index-D_NX9Eof.js";import{_ as m}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BUBYiqAX.js";import{_ as F,a as S,b as z,c as D}from"./CardTitle.vue_vue_type_script_setup_true_lang-BhpnJ5ya.js";import{_ as I,a as U,b as A,c as B,d as M}from"./DialogTitle.vue_vue_type_script_setup_true_lang-C-SfElTY.js";import{_ as N}from"./DialogFooter.vue_vue_type_script_setup_true_lang-Bw_2LaqB.js";import{_ as O}from"./Input.vue_vue_type_script_setup_true_lang-DLaguvqt.js";import{_ as q}from"./Label.vue_vue_type_script_setup_true_lang-BVYJy_EQ.js";import{u as ue}from"./useDateFormat-BThD_v7S.js";import{F as me,C as T,j as P,d as pe}from"./AppLayout.vue_vue_type_script_setup_true_lang-CwkbJi7E.js";import{A as _e}from"./arrow-left-DWqgfXPD.js";import{D as fe}from"./dollar-sign-DkALKasg.js";import{c as ke}from"./createLucideIcon-CX-op3lg.js";import"./index-BRm__Hk1.js";import"./useForwardPropsEmits-CaKxx7wQ.js";import"./useForwardExpose-D4WvoR71.js";import"./VisuallyHidden-DxCKGmrj.js";import"./index-BDqSilVs.js";const E=ke("ClockIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),ve={class:"flex h-full flex-1 flex-col gap-6 p-6"},ye={class:"flex items-center justify-between"},xe={class:"flex items-center gap-4"},ge={class:"flex items-center gap-2"},be={class:"grid gap-6 lg:grid-cols-2"},he={class:"grid gap-4 sm:grid-cols-2"},$e={class:"text-muted-foreground text-sm"},Ce={class:"font-medium"},je={class:"text-muted-foreground text-sm"},we={class:"font-medium"},Ve={class:"text-muted-foreground text-sm"},Fe={class:"text-lg font-semibold"},Se={class:"text-muted-foreground text-sm"},ze={class:"font-medium"},De={class:"text-muted-foreground text-sm"},Ie={class:"font-medium"},Ue={key:0},Ae={class:"text-muted-foreground text-sm"},Be={class:"font-medium"},Me={key:1},Ne={class:"text-muted-foreground text-sm"},Oe={class:"font-medium"},qe={key:0,class:"border-t pt-4"},Le={class:"text-muted-foreground text-sm"},Re={class:"mt-1"},Te={class:"grid gap-4 sm:grid-cols-2"},Pe={class:"text-muted-foreground text-sm"},Ee={class:"text-lg font-semibold"},Xe={class:"text-muted-foreground text-sm"},Ge={class:"text-lg font-semibold text-green-600"},He={class:"text-muted-foreground text-sm"},Je={class:"text-lg font-semibold text-orange-600"},Ke={class:"text-muted-foreground text-sm"},Qe={key:0,class:"space-y-4"},We={class:"flex-1"},Ye={class:"flex items-center justify-between"},Ze={class:"font-medium"},et={key:0,class:"text-muted-foreground text-sm"},tt={key:1,class:"mt-1 text-sm"},at={key:2,class:"mt-3 flex gap-2"},st={key:1,class:"text-muted-foreground py-8 text-center"},rt={class:"space-y-2"},nt={class:"space-y-2"},ot={key:0,class:"text-sm text-destructive"},lt={class:"space-y-2"},Vt=se({__name:"Show",props:{ticket:{}},setup(X){const f=X,{t:n}=re(),{formatDateOnly:G,formatDateTime:H}=ue(),J=[{title:n("nav.payment_tracker"),href:"/payment-tracker"},{title:f.ticket.number,href:"#"}];function K(){R.get("/payment-tracker")}function b(_){return _==null?"-":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(_)}function L(_){switch(_){case"paid":return"default";case"approved":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}}function Q(_){switch(_){case"approved":return T;case"rejected":return P;default:return E}}function W(_){switch(_){case"approved":return"text-green-600";case"rejected":return"text-red-600";default:return"text-muted-foreground"}}const v=w(!1),y=w(!1),x=w(!1),h=C({remarks:""}),k=C({remarks:""}),$=C({reference_no:""});function Y(){h.post(`/payment-tracker/${f.ticket.id}/approve`,{onSuccess:()=>{v.value=!1}})}function Z(){k.post(`/payment-tracker/${f.ticket.id}/reject`,{onSuccess:()=>{y.value=!1}})}function ee(){$.post(`/payment-tracker/${f.ticket.id}/mark-paid`,{onSuccess:()=>{x.value=!1}})}function te(){R.post(`/payment-tracker/${f.ticket.id}/submit`)}const l=f.ticket;return(_,i)=>(d(),g(pe,{breadcrumbs:J},{default:r(()=>[t(e(ne),{title:`${e(n)("nav.payment_tracker")} - ${e(l).number}`},null,8,["title"]),s("div",ve,[s("div",ye,[s("div",xe,[t(e(m),{variant:"outline",size:"icon",onClick:K},{default:r(()=>[t(e(_e),{class:"size-4"})]),_:1}),t(de,{title:e(l).number,description:e(n)("payment_tracker.ticket_payment_detail")},null,8,["title","description"])]),s("div",ge,[t(e(V),{variant:L(e(l).approval_status)},{default:r(()=>[c(a(e(n)(`payment_tracker.statuses.${e(l).approval_status}`)),1)]),_:1},8,["variant"]),e(l).approval_status==="draft"?(d(),g(e(m),{key:0,onClick:te},{default:r(()=>[c(a(e(n)("payment_tracker.submit_for_approval")),1)]),_:1})):p("",!0),e(l).approval_status==="approved"?(d(),g(e(m),{key:1,variant:"default",onClick:i[0]||(i[0]=o=>x.value=!0)},{default:r(()=>[t(e(fe),{class:"mr-2 size-4"}),c(" "+a(e(n)("payment_tracker.mark_paid")),1)]),_:1})):p("",!0)])]),s("div",be,[t(e(F),null,{default:r(()=>[t(e(S),null,{default:r(()=>[t(e(z),null,{default:r(()=>[c(a(e(n)("payment_tracker.payment_info")),1)]),_:1})]),_:1}),t(e(D),{class:"space-y-4"},{default:r(()=>[s("div",he,[s("div",null,[s("p",$e,a(e(n)("tickets.number")),1),s("p",Ce,a(e(l).number),1)]),s("div",null,[s("p",je,a(e(n)("tickets.date")),1),s("p",we,a(e(G)(e(l).date)),1)]),s("div",null,[s("p",Ve,a(e(n)("payment_tracker.amount")),1),s("p",Fe,a(b(e(l).amount)),1)]),s("div",null,[s("p",Se,a(e(n)("tickets.contract")),1),s("p",ze,a(e(l).contract?.number??"-"),1)]),s("div",null,[s("p",De,a(e(n)("tickets.vendor")),1),s("p",Ie,a(e(l).vendor?.name??"-"),1)]),e(l).reference_no?(d(),u("div",Ue,[s("p",Ae,a(e(n)("payment_tracker.reference_no")),1),s("p",Be,a(e(l).reference_no),1)])):p("",!0),e(l).replaces_ticket?(d(),u("div",Me,[s("p",Ne,a(e(n)("payment_tracker.replaces")),1),s("p",Oe,a(e(l).replaces_ticket.number),1)])):p("",!0)]),e(l).notes?(d(),u("div",qe,[s("p",Le,a(e(n)("tickets.notes")),1),s("p",Re,a(e(l).notes),1)])):p("",!0)]),_:1})]),_:1}),e(l).contract?(d(),g(e(F),{key:0},{default:r(()=>[t(e(S),null,{default:r(()=>[t(e(z),null,{default:r(()=>[c(a(e(n)("payment_tracker.contract_balance")),1)]),_:1})]),_:1}),t(e(D),{class:"space-y-4"},{default:r(()=>[s("div",Te,[s("div",null,[s("p",Pe,a(e(n)("contracts.amount")),1),s("p",Ee,a(b(e(l).contract.amount)),1)]),s("div",null,[s("p",Xe,a(e(n)("contracts.total_paid")),1),s("p",Ge,a(b(e(l).contract.payment_total_paid??0)),1)]),s("div",null,[s("p",He,a(e(n)("contracts.outstanding_balance")),1),s("p",Je,a(b(e(l).contract.payment_balance??e(l).contract.amount)),1)]),s("div",null,[s("p",Ke,a(e(n)("contracts.cooperation_type")),1),t(e(V),{variant:e(l).contract.cooperation_type==="progress"?"default":"secondary"},{default:r(()=>[c(a(e(n)(`contracts.types.${e(l).contract.cooperation_type}`)),1)]),_:1},8,["variant"])])])]),_:1})]),_:1})):p("",!0)]),t(e(F),null,{default:r(()=>[t(e(S),null,{default:r(()=>[t(e(z),{class:"flex items-center gap-2"},{default:r(()=>[t(e(me),{class:"size-5"}),c(" "+a(e(n)("payment_tracker.approval_steps")),1)]),_:1})]),_:1}),t(e(D),null,{default:r(()=>[e(l).approval_steps?.length?(d(),u("div",Qe,[(d(!0),u(oe,null,le(e(l).approval_steps,o=>(d(),u("div",{key:o.id,class:"flex items-start gap-4 rounded-lg border p-4"},[(d(),g(ce(Q(o.status)),{class:ie(["mt-0.5 size-5 shrink-0",W(o.status)])},null,8,["class"])),s("div",We,[s("div",Ye,[s("p",Ze," #"+a(o.sequence_no)+" â€” "+a(o.approver?.name??"Unknown"),1),t(e(V),{variant:L(o.status)},{default:r(()=>[c(a(e(n)(`payment_tracker.statuses.${o.status}`)),1)]),_:2},1032,["variant"])]),o.acted_at?(d(),u("p",et,a(e(H)(o.acted_at)),1)):p("",!0),o.remarks?(d(),u("p",tt,a(o.remarks),1)):p("",!0),o.status==="pending"&&e(l).approval_status==="pending"?(d(),u("div",at,[t(e(m),{size:"sm",onClick:i[1]||(i[1]=ae=>v.value=!0)},{default:r(()=>[t(e(T),{class:"mr-1 size-4"}),c(" "+a(e(n)("payment_tracker.approve")),1)]),_:1}),t(e(m),{size:"sm",variant:"destructive",onClick:i[2]||(i[2]=ae=>y.value=!0)},{default:r(()=>[t(e(P),{class:"mr-1 size-4"}),c(" "+a(e(n)("payment_tracker.reject")),1)]),_:1})])):p("",!0)])]))),128))])):(d(),u("div",st,[t(e(E),{class:"mx-auto mb-2 size-8 opacity-50"}),s("p",null,a(e(n)("payment_tracker.no_approval_steps")),1)]))]),_:1})]),_:1})]),t(e(I),{open:v.value,"onUpdate:open":i[5]||(i[5]=o=>v.value=o)},{default:r(()=>[t(e(U),{class:"sm:max-w-[400px]"},{default:r(()=>[t(e(A),null,{default:r(()=>[t(e(B),null,{default:r(()=>[c(a(e(n)("payment_tracker.confirm_approve")),1)]),_:1}),t(e(M),null,{default:r(()=>[c(a(e(n)("payment_tracker.approve_description")),1)]),_:1})]),_:1}),s("form",{onSubmit:j(Y,["prevent"]),class:"space-y-4"},[s("div",rt,[t(e(q),null,{default:r(()=>[c(a(e(n)("payment_tracker.remarks")),1)]),_:1}),t(e(O),{modelValue:e(h).remarks,"onUpdate:modelValue":i[3]||(i[3]=o=>e(h).remarks=o),placeholder:e(n)("payment_tracker.remarks_placeholder")},null,8,["modelValue","placeholder"])]),t(e(N),null,{default:r(()=>[t(e(m),{type:"button",variant:"outline",onClick:i[4]||(i[4]=o=>v.value=!1)},{default:r(()=>[c(a(e(n)("common.cancel")),1)]),_:1}),t(e(m),{type:"submit",disabled:e(h).processing},{default:r(()=>[c(a(e(n)("payment_tracker.approve")),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),t(e(I),{open:y.value,"onUpdate:open":i[8]||(i[8]=o=>y.value=o)},{default:r(()=>[t(e(U),{class:"sm:max-w-[400px]"},{default:r(()=>[t(e(A),null,{default:r(()=>[t(e(B),null,{default:r(()=>[c(a(e(n)("payment_tracker.confirm_reject")),1)]),_:1}),t(e(M),null,{default:r(()=>[c(a(e(n)("payment_tracker.reject_description")),1)]),_:1})]),_:1}),s("form",{onSubmit:j(Z,["prevent"]),class:"space-y-4"},[s("div",nt,[t(e(q),null,{default:r(()=>[c(a(e(n)("payment_tracker.remarks"))+" *",1)]),_:1}),t(e(O),{modelValue:e(k).remarks,"onUpdate:modelValue":i[6]||(i[6]=o=>e(k).remarks=o),placeholder:e(n)("payment_tracker.remarks_placeholder"),required:""},null,8,["modelValue","placeholder"]),e(k).errors.remarks?(d(),u("p",ot,a(e(k).errors.remarks),1)):p("",!0)]),t(e(N),null,{default:r(()=>[t(e(m),{type:"button",variant:"outline",onClick:i[7]||(i[7]=o=>y.value=!1)},{default:r(()=>[c(a(e(n)("common.cancel")),1)]),_:1}),t(e(m),{type:"submit",variant:"destructive",disabled:e(k).processing},{default:r(()=>[c(a(e(n)("payment_tracker.reject")),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),t(e(I),{open:x.value,"onUpdate:open":i[11]||(i[11]=o=>x.value=o)},{default:r(()=>[t(e(U),{class:"sm:max-w-[400px]"},{default:r(()=>[t(e(A),null,{default:r(()=>[t(e(B),null,{default:r(()=>[c(a(e(n)("payment_tracker.confirm_paid")),1)]),_:1}),t(e(M),null,{default:r(()=>[c(a(e(n)("payment_tracker.paid_description")),1)]),_:1})]),_:1}),s("form",{onSubmit:j(ee,["prevent"]),class:"space-y-4"},[s("div",lt,[t(e(q),null,{default:r(()=>[c(a(e(n)("payment_tracker.reference_no")),1)]),_:1}),t(e(O),{modelValue:e($).reference_no,"onUpdate:modelValue":i[9]||(i[9]=o=>e($).reference_no=o),placeholder:e(n)("payment_tracker.reference_placeholder")},null,8,["modelValue","placeholder"])]),t(e(N),null,{default:r(()=>[t(e(m),{type:"button",variant:"outline",onClick:i[10]||(i[10]=o=>x.value=!1)},{default:r(()=>[c(a(e(n)("common.cancel")),1)]),_:1}),t(e(m),{type:"submit",disabled:e($).processing},{default:r(()=>[c(a(e(n)("payment_tracker.mark_paid")),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Vt as default};
