import{d as C,u as q,a as E,c as L,b as d,e as t,f as e,h as D,g as r,x as U,l as M,j as m,t as a,i as f,m as p,k as x,F as R,p as T,s as G,q as H}from"./app-CuI7LdXL.js";import{_ as J}from"./Heading.vue_vue_type_script_setup_true_lang-BHjUqA3V.js";import{_ as k}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BUBYiqAX.js";import{_ as V,a as B,b as P,c as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-BhpnJ5ya.js";import{_ as w}from"./CardDescription.vue_vue_type_script_setup_true_lang-D4LN3jrC.js";import{_ as v}from"./Checkbox.vue_vue_type_script_setup_true_lang-BHWKOiH2.js";import{_ as K}from"./Input.vue_vue_type_script_setup_true_lang-DLaguvqt.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-BVYJy_EQ.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-BYhBP41M.js";import{k as b,d as Q,n as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-CwkbJi7E.js";import{A as X}from"./arrow-left-DWqgfXPD.js";import{S as Y}from"./save-BUK-ELRm.js";import"./useForwardPropsEmits-CaKxx7wQ.js";import"./VisuallyHidden-DxCKGmrj.js";import"./useForwardExpose-D4WvoR71.js";import"./VisuallyHiddenInput-8nto7-pU.js";import"./check-CLJgvc3L.js";import"./createLucideIcon-CX-op3lg.js";import"./index-BRm__Hk1.js";import"./index-BDqSilVs.js";const Z={class:"p-6"},ee={class:"flex gap-4 items-start"},se={class:"grid gap-4 sm:grid-cols-2"},te={class:"space-y-2"},ie={key:0,class:"text-sm text-destructive"},de={key:1,class:"text-xs text-muted-foreground"},le={class:"flex items-center space-x-2"},oe={class:"space-y-2"},re={key:0,class:"text-sm text-destructive"},ae={class:"space-y-4"},ce={class:"mb-3 flex items-center justify-between"},ne={class:"font-medium"},me={class:"text-sm text-muted-foreground"},_e={class:"flex items-center gap-2"},fe={class:"text-xs text-muted-foreground"},ue={class:"flex flex-wrap gap-4"},pe={class:"flex items-center space-x-2"},ve={class:"flex items-center space-x-2"},he={class:"flex items-center space-x-2"},ge={class:"flex items-center space-x-2"},xe={key:0,class:"mt-2 text-sm text-destructive"},be={class:"flex items-center justify-end gap-4"},Me=C({__name:"Edit",props:{role:{},pages:{},privilegesByPage:{}},setup(y){const _=y,{t:o}=q(),F=G(()=>[{title:o("nav.roles"),href:b().url},{title:_.role.name,href:"#"}]),A=_.pages.map(c=>({page_id:c.id,create:_.privilegesByPage[c.id]?.create||!1,read:_.privilegesByPage[c.id]?.read||!1,update:_.privilegesByPage[c.id]?.update||!1,delete:_.privilegesByPage[c.id]?.delete||!1})),i=E({name:_.role.name,description:_.role.description||"",is_active:_.role.is_active,privileges:A});function I(){i.put(W(_.role.id).url,{preserveScroll:!0,onSuccess:()=>{H.visit(b().url)}})}function N(c,l){const s=i.privileges.findIndex(n=>n.page_id===c);s!==-1&&(i.privileges[s].create=l,i.privileges[s].read=l,i.privileges[s].update=l,i.privileges[s].delete=l)}function h(c){return i.privileges.find(l=>l.page_id===c)}function g(c,l,s){const n=i.privileges.findIndex(z=>z.page_id===c);n!==-1&&(i.privileges[n][l]=s)}function j(c){const l=i.privileges.find(s=>s.page_id===c);return l?l.create&&l.read&&l.update&&l.delete:!1}function $(){return _.role?.is_system??!1}return(c,l)=>(f(),L(Q,{breadcrumbs:F.value},{default:d(()=>[t(e(D),{title:e(o)("roles.edit")},null,8,["title"]),r("div",Z,[r("div",ee,[t(e(U),{href:e(b)().url},{default:d(()=>[t(e(k),{variant:"ghost",size:"icon"},{default:d(()=>[t(e(X),{class:"size-4"})]),_:1})]),_:1},8,["href"]),t(J,{title:e(o)("roles.edit"),description:e(o)("roles.edit_description")},null,8,["title","description"])]),r("form",{onSubmit:M(I,["prevent"]),class:"space-y-6"},[t(e(V),null,{default:d(()=>[t(e(B),null,{default:d(()=>[t(e(P),null,{default:d(()=>[m(a(e(o)("roles.basic_info")),1)]),_:1}),t(e(w),null,{default:d(()=>[m(a(e(o)("roles.basic_info_description")),1)]),_:1})]),_:1}),t(e(S),{class:"space-y-4"},{default:d(()=>[r("div",se,[r("div",te,[t(e(u),{for:"name"},{default:d(()=>[m(a(e(o)("roles.name")),1)]),_:1}),t(e(K),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":l[0]||(l[0]=s=>e(i).name=s),disabled:e(i).processing||$(),required:""},null,8,["modelValue","disabled"]),e(i).errors.name?(f(),p("p",ie,a(e(i).errors.name),1)):x("",!0),$()?(f(),p("p",de,a(e(o)("roles.system_role_locked")),1)):x("",!0)]),r("div",le,[t(e(v),{id:"is_active",checked:e(i).is_active,"onUpdate:checked":l[1]||(l[1]=s=>e(i).is_active=s),disabled:e(i).processing},null,8,["checked","disabled"]),t(e(u),{for:"is_active",class:"font-normal"},{default:d(()=>[m(a(e(o)("roles.is_active")),1)]),_:1})])]),r("div",oe,[t(e(u),{for:"description"},{default:d(()=>[m(a(e(o)("roles.description_field")),1)]),_:1}),t(e(O),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":l[2]||(l[2]=s=>e(i).description=s),disabled:e(i).processing,rows:2},null,8,["modelValue","disabled"]),e(i).errors.description?(f(),p("p",re,a(e(i).errors.description),1)):x("",!0)])]),_:1})]),_:1}),t(e(V),null,{default:d(()=>[t(e(B),null,{default:d(()=>[t(e(P),null,{default:d(()=>[m(a(e(o)("roles.page_privileges")),1)]),_:1}),t(e(w),null,{default:d(()=>[m(a(e(o)("roles.page_privileges_description")),1)]),_:1})]),_:1}),t(e(S),null,{default:d(()=>[r("div",ae,[(f(!0),p(R,null,T(y.pages,s=>(f(),p("div",{key:s.id,class:"rounded-lg border p-4"},[r("div",ce,[r("div",null,[r("h4",ne,a(s.name),1),r("p",me,a(s.description),1)]),r("div",_e,[t(e(v),{checked:j(s.id),"onUpdate:checked":n=>N(s.id,n),disabled:e(i).processing},null,8,["checked","onUpdate:checked","disabled"]),r("span",fe,a(e(o)("common.select_all")),1)])]),r("div",ue,[r("div",pe,[t(e(v),{id:`${s.id}-create`,checked:h(s.id)?.create??!1,"onUpdate:checked":n=>g(s.id,"create",n),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(u),{for:`${s.id}-create`,class:"font-normal text-sm"},{default:d(()=>[m(a(e(o)("common.create")),1)]),_:1},8,["for"])]),r("div",ve,[t(e(v),{id:`${s.id}-read`,checked:h(s.id)?.read??!1,"onUpdate:checked":n=>g(s.id,"read",n),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(u),{for:`${s.id}-read`,class:"font-normal text-sm"},{default:d(()=>[m(a(e(o)("common.read")),1)]),_:1},8,["for"])]),r("div",he,[t(e(v),{id:`${s.id}-update`,checked:h(s.id)?.update??!1,"onUpdate:checked":n=>g(s.id,"update",n),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(u),{for:`${s.id}-update`,class:"font-normal text-sm"},{default:d(()=>[m(a(e(o)("common.update")),1)]),_:1},8,["for"])]),r("div",ge,[t(e(v),{id:`${s.id}-delete`,checked:h(s.id)?.delete??!1,"onUpdate:checked":n=>g(s.id,"delete",n),disabled:e(i).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(u),{for:`${s.id}-delete`,class:"font-normal text-sm"},{default:d(()=>[m(a(e(o)("common.delete")),1)]),_:1},8,["for"])])])]))),128))]),e(i).errors.privileges?(f(),p("p",xe,a(e(i).errors.privileges),1)):x("",!0)]),_:1})]),_:1}),r("div",be,[t(e(U),{href:e(b)().url},{default:d(()=>[t(e(k),{type:"button",variant:"outline",disabled:e(i).processing},{default:d(()=>[m(a(e(o)("common.cancel")),1)]),_:1},8,["disabled"])]),_:1},8,["href"]),t(e(k),{type:"submit",disabled:e(i).processing},{default:d(()=>[t(e(Y),{class:"mr-2 size-4"}),m(" "+a(e(i).processing?e(o)("common.saving"):e(o)("common.save")),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["breadcrumbs"]))}});export{Me as default};
